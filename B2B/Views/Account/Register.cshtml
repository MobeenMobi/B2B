@model B2B.ViewModels.RegisterViewModel;
@{
	Layout = null;
}
@{
	Layout = ""; // works in some ASP.NET setups where null is ignored
}

<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>Register</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
	<style>
		label span.required {
			color: red;
		}
	</style>
</head>


<body class="bg-light d-flex align-items-center justify-content-center">
	<div class="card p-4 shadow" style="background-color:#89CFF0; color:white; max-width:600px; width:100%;">
		<h4 class="text-center mb-4">Register</h4>
		<ul class="nav nav-pills mb-3 justify-content-center" id="pills-tab" role="tablist">
			<li class="nav-item" role="presentation">
				<button class="nav-link active" id="step1-tab" data-bs-toggle="pill" data-bs-target="#step1" type="button" role="tab">● Business Particular</button>
			</li>
			<li class="nav-item" role="presentation">
				<button class="nav-link" id="step2-tab" data-bs-toggle="pill" data-bs-target="#step2" type="button" role="tab">● Bank Details</button>
			</li>
			<li class="nav-item" role="presentation">
				<button class="nav-link" id="step3-tab" data-bs-toggle="pill" data-bs-target="#step3" type="button" role="tab">● Person In Charge</button>
			</li>
		</ul>
		<form method="post" action="/Account/Register" enctype="multipart/form-data">
			<div class="tab-content" id="pills-tabContent">
				<div class="tab-pane fade show active" id="step1" role="tabpanel">
					<div class="mb-3">
						<label>Company / Institution Name <span class="required">*</span></label>
						<input asp-for="Company.CompanyName" class="form-control" required />
					</div>

					<div class="mb-3">
						<label>Registration Number <span class="required">*</span></label>
						<input asp-for="Company.RegistrationNumber" class="form-control" required />
					</div>

					<div class="mb-3">
						<label>Date of Incorporation <span class="required">*</span></label>
						<input asp-for="Company.DateOfIncorporation" type="date" class="form-control" required />
					</div>

					<div class="mb-3">
						<label>Location of Incorporation <span class="required">*</span></label>
						<input asp-for="Company.LocationOfIncorporation" class="form-control" required />
					</div>

					<div class="mb-3">
						<label>Business / Industry Type <span class="required">*</span></label>
						<select asp-for="Company.BusinessType" id="businessTypeSelect" class="form-control" required>
							<option value="">Please Select Business / Industry Type</option>
							<option value="NGO (Association/Club/Society)">MY - NGO (Association/Club/Society)</option>
							<option value="Partnership (2 to 20 Owners)">MY - Partnership (2 to 20 Owners)</option>
							<option value="Private Limited (Sdn. Bhd. Corporation)">MY - Private Limited (Sdn. Bhd. Corporation)</option>
							<option value="Public Listed Corporation">MY – State Owned Corporation & Public Listed Company</option>
							<option value="Sole Proprietorship (One Owner)">MY - Sole Proprietorship (One Owner)</option>
						</select>
					</div>

					<div id="businessTypeDocs" class="mt-3 p-3 border rounded" style="display:none; background-color:#89CFF0;"></div>

					<div class="mb-3">
						<label class="form-label">Upload Documents</label>
						<input asp-for="DocumentUpload.Documents" class="form-control" type="file" multiple />
					</div>

					<div class="mb-3">
						<label>Nature of Business <span class="required">*</span></label>
						<select asp-for="Company.NatureOfBusiness" class="form-control" required>
							<option value="Agriculture/Forestry/Logging">Agriculture/Forestry/Logging</option>
							<option value="Amusement & Recreation Services">Amusement & Recreation Services</option>
							<option value="Building Society">Building Society</option>
							<option value="Business Services">Business Services</option>
							<option value="Construction">Construction</option>
							<option value="Education">Education</option>
							<option value="Finance">Finance</option>
							<option value="Government">Government</option>
							<option value="Health and Social Work">Health and Social Work</option>
							<option value="Hotel">Hotel</option>
							<option value="Household">Household</option>
							<option value="Import/Export">Import/Export</option>
							<option value="Information and Communication">Information and Communication</option>
							<option value="Insurance">Insurance</option>
							<option value="International Bodies">International Bodies</option>
							<option value="Legal">Legal</option>
						</select>

					</div>

					<div class="mb-3">
						<label>Short Business Description <span class="required">*</span></label>
						<input asp-for="Company.ShortBusinessDescription" class="form-control" placeholder="eg: Hajo Agent" required/>
					</div>

					<div class="mb-3">
						<label>Company Email <span class="required">*</span></label>
						<input asp-for="Company.CompanyEmail" class="form-control" required/>
					</div>

					<div class="mb-3">
						<label>Company Website</label>
						<input asp-for="Company.CompanyWebsite" type="url" class="form-control" />
					</div>

					<div class="mb-3">
						<label>Phone No <span class="required">*</span></label>
						<input asp-for="Company.PhoneNo" class="form-control" required />
					</div>

					<div class="mb-3">
						<label>Company / Organization / Mailing Address <span class="required">*</span></label>
						<input asp-for="Company.AddressLine1" placeholder="Address line 1" class="form-control mb-2" required />
						<input asp-for="Company.AddressLine2" placeholder="Address line 2 (Optional)" class="form-control mb-2" />
						<input asp-for="Company.AddressLine3" placeholder="Address line 3 (Optional)" class="form-control" />
					</div>

					<div class="mb-3">
						<label>City <span class="required">*</span></label>
						<input asp-for="Company.City" class="form-control" required />

					</div>

					<div class="mb-3">
						<label>Postcode <span class="required">*</span></label>
						<input asp-for="Company.Postcode" class="form-control" required />
					</div>

					<div class="mb-3">
						<label>State <span class="required">*</span></label>
						<select asp-for="Company.State" class="form-control" required>
							<option value="Johor">Johor</option>
							<option value="Kedah">Kedah</option>
							<option value="Kelantan">Kelantan</option>
							<option value="Malacca">Malacca</option>
							<option value="Negeri Sembilan">Negeri Sembilan</option>
							<option value="Pahang">Pahang</option>
							<option value="Penang">Penang</option>
							<option value="Perak">Perak</option>
							<option value="Perlis">Perlis</option>
							<option value="Sabah">Sabah</option>
							<option value="Sarawak">Sarawak</option>
							<option value="Selangor">Selangor</option>
							<option value="Terengganu">Terengganu</option>
							<!-- Federal Territories -->
							<option value="Kuala Lumpur">Kuala Lumpur</option>
							<option value="Labuan">Labuan</option>
							<option value="Putrajaya">Putrajaya</option>
						</select>
					</div>

					<div class="mb-3">
						<label>Country <span class="required">*</span></label>
						<input asp-for="Company.Country" class="form-control" value="Malaysia" disabled required />
					</div>

					<button class="btn btn-primary w-100" type="button" onclick="validateStep(1, 2)">Next</button>
				</div>
				<div class="tab-pane fade" id="step2" role="tabpanel">
					<div class="mb-3">
						<label>Bank <span class="required">*</span></label>
						<select asp-for="Bank.Bank" id="Bank" class="form-control" required>
							<option value="">-- Select Bank --</option>
							<option value="Affin Bank Berhad">Affin Bank Berhad</option>
							<option value="Agrobank Malaysia">Agrobank Malaysia</option>
							<option value="Al Rajhi Bank (Malaysia)">Al Rajhi Bank (Malaysia)</option>
							<option value="Alliance Bank Malaysia Berhad">Alliance Bank Malaysia Berhad</option>
							<option value="AmBank Group Berhad (AmBank)">AmBank Group Berhad (AmBank)</option>
							<option value="Bangkok Bank Berhad (Malaysia)">Bangkok Bank Berhad (Malaysia)</option>
							<option value="Bank Islam Malaysia Berhad">Bank Islam Malaysia Berhad</option>
							<option value="Bank Muamalat Malaysia Berhad">Bank Muamalat Malaysia Berhad</option>
							<option value="Bank of China (Malaysia) Berhad">Bank of China (Malaysia) Berhad</option>
							<option value="Bank Rakyat Malaysia Berhad">Bank Rakyat Malaysia Berhad</option>
							<option value="Bank Simpanan Nasional (BSN)">Bank Simpanan Nasional (BSN)</option>
							<option value="BNP Paribas Malaysia Berhad">BNP Paribas Malaysia Berhad</option>
							<option value="CIMB Group Holdings Berhad (CIMB)">CIMB Group Holdings Berhad (CIMB)</option>
							<option value="Citibank Berhad (Malaysia)">Citibank Berhad (Malaysia)</option>
							<option value="Deutsche Bank (Malaysia) Berhad">Deutsche Bank (Malaysia) Berhad</option>
							<option value="Hong Leong Bank Berhad">Hong Leong Bank Berhad</option>
							<option value="HSBC Bank Malaysia Berhad">HSBC Bank Malaysia Berhad</option>
							<option value="ICBC (Malaysia) Berhad (Industrial &amp; Commercial Bank of China Malaysia)">ICBC (Malaysia) Berhad (Industrial &amp; Commercial Bank of China Malaysia)</option>
							<option value="Malayan Banking Berhad (Maybank)">Malayan Banking Berhad (Maybank)</option>
							<option value="MBSB Bank Berhad">MBSB Bank Berhad</option>
							<option value="OCBC Bank (Malaysia) Berhad">OCBC Bank (Malaysia) Berhad</option>
							<option value="Public Bank Berhad">Public Bank Berhad</option>
							<option value="RHB Bank Berhad">RHB Bank Berhad</option>
							<option value="Standard Chartered Bank Malaysia">Standard Chartered Bank Malaysia</option>
							<option value="United Overseas Bank (Malaysia) (UOB Malaysia)">United Overseas Bank (Malaysia) (UOB Malaysia)</option>
						</select>

					</div>
					<div class="mb-3"><label>Bank Account Holder Name <span class="required">*</span></label><input asp-for="Bank.AccountHolder" class="form-control" required /></div>
					<div class="mb-3"><label>Bank Account Number <span class="required">*</span></label><input asp-for="Bank.AccountNumber" class="form-control" required /></div>
					<div class="mb-3"><label>Average Annual Trunover <span class="required">*</span></label><input asp-for="Bank.AverageAnnualTrunover" class="form-control" required /></div>
					<div class="mb-3">
						<label>Remittance Details <span class="required">*</span></label>
						<table class="table table-bordered" id="remitTable">
							<thead>
								<tr>
									<th>No.</th>
									<th>Country Name <span class="required"></span></th>
									<th>Purpose of Remit <span class="required"></span></th>
									<th>Action</th>
								</tr>
							</thead>
							<tbody>
								<tr>
									<td>1</td>
									<td><input name="Bank.RemittanceDetails[0].CountryName" class="form-control" required /></td>
									<td><input name="Bank.RemittanceDetails[0].PurposeOfRemit" class="form-control" required /></td>
									<td><button type="button" class="btn btn-danger btn-sm" onclick="removeRow(this)">Remove</button></td>
								</tr>
							</tbody>
						</table>
						<button type="button" class="btn btn-success btn-sm" onclick="addRow()">Add Row</button>
					</div>

					<button class="btn btn-secondary w-100 mb-2" type="button" onclick="validateStep(2,1)">Back</button>
					<button class="btn btn-primary w-100" type="button" onclick="validateStep(2, 3)">Next</button>
				</div>
				<div class="tab-pane fade" id="step3" role="tabpanel">
@* 					<div class="mb-3">
						<label class="form-label">Control Option <span class="required">*</span></label>
						<div class="form-check form-check-inline">
							<input asp-for="User.ControlOption" type="radio" class="form-check-input" value="Single" required />
							<label class="form-check-label">Single Control</label>
						</div><div class="form-check form-check-inline">
							<input class="form-check-input" type="radio" name="ControlOption" value="Dual">
							<input asp-for="User.ControlOption" type="radio" class="form-check-input" value="Dual" />
							<label class="form-check-label">Dual Control</label>
						</div>
					</div> *@
					<div class="mb-3">
						<label class="form-label">First Name <span class="required">*</span></label>
						<input asp-for="User.FirstName" class="form-control" required />
					</div>
					<div class="mb-3">
						<label class="form-label">Middle Name</label>
						<input asp-for="User.MiddleName" class="form-control" />
					</div>
					<div class="mb-3">
						<label class="form-label">Last Name</label>
						<input asp-for="User.LastName" class="form-control" />
					</div>
@* 					<div class="mb-3">
						<label class="form-label">Nationality <span class="required">*</span></label>
						<select asp-for="User.Nationality" class="form-control" required>
							<option value="">Select nationality...</option>
							<option value="MY">Malaysia</option>
							<option value="PK">Pakistan</option>
							<option value="IN">India</option>
						</select>
					</div>
					<div class="mb-3">
						<label class="form-label">Date of Birth <span class="required">*</span></label>
						<input asp-for="User.DateOfBirth" type="date" class="form-control" required />
					</div>
					<div class="mb-3">
						<label class="form-label">Gender <span class="required">*</span></label>
						<div class="form-check form-check-inline">
							<input asp-for="User.Gender" class="form-check-input" type="radio" value="Female" required />
							<label class="form-check-label">Female</label>
						</div>
						<div class="form-check form-check-inline">
							<input asp-for="User.Gender" class="form-check-input" type="radio" value="Male" />
							<label class="form-check-label">Male</label>
						</div>
					</div> *@
					<div class="mb-3">
						<label class="form-label">Email <span class="required">*</span></label>
						<input asp-for="User.Email" type="email" class="form-control" required />
					</div>

					<div class="mb-3">
						<label class="form-label">ID Type <span class="required">*</span></label>
						<select asp-for="User.IDType" class="form-select" required>
							<option>MyKad</option>
							<option>Passport</option>
						</select>
					</div>

					<div class="mb-3">
						<label class="form-label">ID Number <span class="required">*</span></label>
						<input asp-for="User.IDNumber" class="form-control" required />
					</div>

					<div class="mb-3">
						<label class="form-label">Phone Number <span class="required">*</span></label>
						<input asp-for="User.PhoneNumber" class="form-control" required />
					</div>

@* 					<div class="mb-3">
						<label class="form-label">Address <span class="required">*</span></label>
						<textarea asp-for="User.Address" class="form-control" rows="2" required></textarea>
					</div>

					<div class="mb-3">
						<label class="form-label">Country <span class="required">*</span></label>
						<input asp-for="User.Country" class="form-control" required />
					</div>

					<div class="mb-3">
						<label class="form-label">City <span class="required">*</span></label>
						<input asp-for="User.City" class="form-control" required />
					</div>

					<div class="mb-3">
						<label class="form-label">Postcode <span class="required">*</span></label>
						<input asp-for="User.Postcode" class="form-control" required />
					</div>

					<div class="mb-3">
						<label class="form-label">State <span class="required">*</span></label>
						<input asp-for="User.State" class="form-control" required />
					</div> *@

					<div class="mb-3">
						<label class="form-label">Designation <span class="required">*</span></label>
						<input asp-for="User.Occupation" class="form-control" required />
					</div>

					<div class="mb-3">
						<label class="form-label">Approver Name</label>
						<input asp-for="User.ApproverName" class="form-control" />
					</div>

					<div class="mb-3">
						<label class="form-label">Password <span class="required">*</span></label>

						<div class="input-group">
							<input asp-for="User.Password"
								   type="password"
								   class="form-control"
								   id="passwordField"
								   required />

							<span class="input-group-text" style="cursor:pointer" onclick="togglePassword()">
								<i class="fa-solid fa-eye-slash" id="eyeIcon"></i>
							</span>
						</div>
					</div>


					<div class="mb-3">
						<label class="form-label">Re-type Password <span class="required">*</span></label>

						<div class="input-group">
							<input type="password"
								   class="form-control"
								   id="confirmPasswordField"
								   required />

							<span class="input-group-text" style="cursor:pointer"
								  onclick="toggleConfirmPassword()">
								<i class="fa-solid fa-eye-slash" id="confirmEyeIcon"></i>
							</span>
						</div>
					</div>


					<div class="form-check mb-3">
						<input asp-for="User.Agree" class="form-check-input" type="checkbox" required />
@* 						<label class="form-check-label">I agree to the Terms and Conditions</label> *@
						<label class="form-check-label">
							I agree to the
							<a href="@Url.Content("~/files/TermsAndConditions.docx")" class="small" target="_blank">Terms and Conditions</a>
						</label>
					</div>

					<button class="btn btn-secondary w-100 mb-2" type="button" onclick="nextStep(3,2)">Back</button>
					<button class="btn btn-success w-100" type="submit">Submit</button>
				</div>
			</div>
		</form>
	</div>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>


	<script>
		function validateStep(currentStep, nextStep) {
			let isValid = true;

			// Get all required input fields inside the current step
			document.querySelectorAll(`#step${currentStep} input[required], #step${currentStep} select[required], #step${currentStep} textarea[required]`)
				.forEach(input => {
					if (!input.value.trim()) {
						input.classList.add("is-invalid");  // Highlight as error
						isValid = false;
					} else {
						input.classList.remove("is-invalid"); // Remove error if fixed
					}
				});

			if (isValid) {
				// ✅ If valid, move to next step
				var tabTrigger = new bootstrap.Tab(document.querySelector('#step' + nextStep + '-tab'));
				tabTrigger.show();
				window.scrollTo({ top: 0, behavior: "smooth" });
			}
		}
		$(document).ready(function() {

			$('#businessTypeSelect').on('change', function() {
				var type = $(this).val();
				var html = '';

				switch(type) {

					case "Private Limited (Sdn. Bhd. Corporation)":
						html = `
						<b>Required Documents</b>
						<ol>
							<li>Memorandum & Article of Association (M&A)</li>
							<li>Form 9 – Certificate of Incorporation or equivalent official document</li>
							<li>Latest Form 24 or equivalent official document</li>
							<li>Latest Form 49 or equivalent official document</li>
							<li>NRIC / Passport Copy of Director(s) or Shareholder(s)</li>
							<li>NRIC / Passport Copy of Authorized person</li>
							<li>Authorization Form</li>
						</ol>`;
						break;

					case "Sole Proprietorship (One Owner)":
					case "Partnership (2 to 20 Owners)":
						html = `
						<b>Required Documents</b>
						<ol>
							<li>Form D – Certificate of Registration or equivalent official document</li>
							<li>NRIC / Passport Copy of Owner’s / Partner’s</li>
							<li>NRIC / Passport Copy of Authorized Person</li>
							<li>Authorization Form</li>
						</ol>`;
						break;

					case "Public Listed Corporation":
						html = `
						<b>Required Documents</b>
						<ol>
							<li>Authorization Form</li>
							<li>NRIC / Passport Copy of Authorized Person</li>
							<li>NRIC / Passport Copy of Key Responsible Person</li>
						</ol>`;
						break;

					case "NGO (Association/Club/Society)":
						html = `
						<b>Required Documents</b>
						<ol>
							<li>Certificate of Registration or equivalent official document</li>
							<li>Copy of the entity's latest Constitution, Rules & Regulations, or By-Laws</li>
							<li>List of Governing body members on Organization’s letter head</li>
							<li>NRIC / Passport Copy of Governing / Committee members</li>
							<li>NRIC / Passport Copy of Authorized person</li>
							<li>Authorization Form</li>
						</ol>`;
						break;

					default:
						html = '';
				}

				if(html !== '') {
					$('#businessTypeDocs').html(html).show();
				} else {
					$('#businessTypeDocs').hide();
				}
			});

		});
		function addRow() {
			const table = document.getElementById("remitTable").getElementsByTagName('tbody')[0];
			const rowCount = table.rows.length;

			const row = table.insertRow(rowCount);
			row.innerHTML = `
				<td>${rowCount + 1}</td>
				<td><input name="Bank.RemittanceDetails[${rowCount}].CountryName" class="form-control" required /></td>
				<td><input name="Bank.RemittanceDetails[${rowCount}].PurposeOfRemit" class="form-control" required /></td>
				<td><button type="button" class="btn btn-danger btn-sm" onclick="removeRow(this)">Remove</button></td>
			`;
		}

		function removeRow(button) {
			const row = button.closest('tr');
			row.parentNode.removeChild(row);

			// Re-index remaining rows
			const table = document.getElementById("remitTable").getElementsByTagName('tbody')[0];
			Array.from(table.rows).forEach((r, i) => {
				r.cells[0].innerText = i + 1;
				r.cells[1].querySelector('input').setAttribute('name', `Bank.RemittanceDetails[${i}].CountryName`);
				r.cells[2].querySelector('input').setAttribute('name', `Bank.RemittanceDetails[${i}].PurposeOfRemit`);
			});
		}

		function togglePassword() {
			const input = document.getElementById("passwordField");
			const icon = document.getElementById("eyeIcon");

			if (input.type === "password") {
				input.type = "text";
				icon.className = "fa-solid fa-eye";
			} else {
				input.type = "password";
				
			icon.className = "fa-solid fa-eye-slash";
			}
		}

			function toggleConfirmPassword() {
			const input = document.getElementById("confirmPasswordField");
			const icon = document.getElementById("confirmEyeIcon");

			if (input.type === "password") {
				input.type = "text";
				icon.className = "fa-solid fa-eye";
			} else {
				input.type = "password";
				icon.className = "fa-solid fa-eye-slash";
			}
		}


	</script>

</body>
</html>